function insertAtCaret(a,b){if(document.selection){a.focus();var c=a.value.replace(/\r\n/g,"\n");var d=document.selection.createRange();if(d.parentElement()!=a){return false}d.text=b;var e=tmp=a.value.replace(/\r\n/g,"\n");for(var f=0;f<c.length;f++){if(c.charAt(f)!=e.charAt(f))break}for(var g=0,h=0;tmp.match(b)&&(tmp=tmp.replace(b,""))&&g<=f;g=h+b.length){h=e.indexOf(b,g)}}else if(a.selectionStart){var h=a.selectionStart;var i=a.selectionEnd;a.value=a.value.substr(0,h)+b+a.value.substr(i,a.value.length)}if(h!=null){setCaretTo(a,h+b.length)}else{a.value+=b}}function setCaretTo(a,b){if(a.createTextRange){var c=a.createTextRange();c.move('character',b);c.select()}else if(a.selectionStart){a.focus();a.setSelectionRange(b,b)}}